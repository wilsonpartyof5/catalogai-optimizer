import{c as Me,d as Pe,e as We,g as $,h as H,i as je,j as x,k as Ce,l as De,m as Ee,n as Ne}from"/build/_shared/chunk-YXNFWLMP.js";import{b as g}from"/build/_shared/chunk-Q3IECNXJ.js";var re=g(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.createTransportListener=y.fromWindow=y.fromFrame=y.Context=void 0;var G=We(),k=je(),ee=H(),F=x(),L=Ce(),Ie;(function(e){e.Modal="Modal",e.Main="Main"})(Ie=y.Context||(y.Context={}));function Se(e,r,n){var t=[],o=e.host,a=e.window;if(!o)throw G.fromAction("App frame is undefined",G.AppActionType.WINDOW_UNDEFINED);return L.isUnframed&&window.MobileWebView&&Object.assign(window.MobileWebView,{postMessageToIframe:function(i,s){a?.postMessage(i,s),Le(i)&&o.postMessage(JSON.stringify(i.payload),location.origin)},updateIframeUrl:function(i){var s=window.location,u=(e.window||{}).location;try{var f=new URL(i).origin;f===r&&u?u.replace(i):s.href=i}catch{}}}),o.addEventListener("message",function(i){if(!(i.source===o||!k.isAppMessage(i))){if(i.origin!==r){var s="Message origin '"+i.origin+"' does not match app origin '"+r+"'.",u=G.invalidOriginAction(s),f={type:"dispatch",payload:u};a?.postMessage(f,i.origin);return}if(L.isUnframed&&window.MobileWebView){var u=JSON.stringify({id:"unframed://fromClient",origin:r,data:i.data});window.MobileWebView.postMessage(u);return}for(var c=0,h=t;c<h.length;c++){var M=h[c];M(i)}}}),{context:n,localOrigin:r,frameWindow:a,hostFrame:o,dispatch:function(i){a?.postMessage(i,r)},subscribe:function(i){return F.addAndRemoveFromCollection(t,i)}}}y.fromFrame=Se;function qe(e,r){var n=[];return typeof window!==void 0&&window.addEventListener("message",function(t){if(!(window===e&&!L.isUnframed||t.source!==e||!(k.isAppBridgeAction(t.data.payload)||k.isAppMessage(t))))for(var o=0,a=n;o<a.length;o++){var i=a[o];i(t)}}),{localOrigin:r,hostFrame:e,dispatch:function(t){var o;if(!((o=t.source)===null||o===void 0)&&o.host){if(L.isUnframed&&window&&window.MobileWebView){var a=JSON.stringify({id:"unframed://fromClient",origin:r,data:t});window.MobileWebView.postMessage(a);return}var i=new URL("https://"+t.source.host).origin;e.postMessage(t,i)}},subscribe:function(t){return F.addAndRemoveFromCollection(n,t)}}}y.fromWindow=qe;function Fe(){var e=[],r={};function n(t){function o(){if(arguments.length<2)return F.addAndRemoveFromCollection(e,{callback:arguments[0]});var a=Array.from(arguments),i=a[0],s=a[1],u=a[2],f={callback:s,id:u},c={type:i,id:u};return Object.prototype.hasOwnProperty.call(r,i)||(r[i]=[]),t&&t(ee.MessageType.Subscribe,c),F.addAndRemoveFromCollection(r[i],f,function(){t&&t(ee.MessageType.Unsubscribe,c)})}return o}return{createSubscribeHandler:n,handleMessage:function(t){e.forEach(function(o){return o.callback(t)})},handleActionDispatch:function(t){var o=t.type,a=t.payload,i=!1;if(Object.prototype.hasOwnProperty.call(r,o))for(var s=0,u=r[o];s<u.length;s++){var f=u[s],c=f.id,h=f.callback,M=a&&a.id===c;(M||!c)&&(h(a),i=!0)}return i}}}y.createTransportListener=Fe;function Le(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.type==="dispatch"&&typeof e.payload=="object"}});var K=g(W=>{"use strict";var Te=W&&W.__createBinding||(Object.create?function(e,r,n,t){t===void 0&&(t=n),Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,t){t===void 0&&(t=n),e[t]=r[n]}),Re=W&&W.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&Te(r,e,n)};Object.defineProperty(W,"__esModule",{value:!0});Re(re(),W)});var ne=g(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.mockAppBridge=C.serverAppBridge=void 0;var T=$(),R=function(){},te=new Promise(function(){});C.serverAppBridge={dispatch:function(){return{}},error:function(){return R},featuresAvailable:function(){return Promise.reject(T.fromAction("Feature detection is only available on the client side.",T.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject(T.fromAction("State is only available on the client side.",T.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return R}};C.mockAppBridge={dispatch:function(){return{}},error:function(){return R},featuresAvailable:function(){return te},getState:function(){return te},localOrigin:"",hostOrigin:"",subscribe:function(){return R}}});var z=g(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.getWindow=A.getLocation=A.redirect=A.shouldRedirect=void 0;function Ue(e){return e===window}A.shouldRedirect=Ue;function Ve(e){var r=ie();r&&r.assign(e)}A.redirect=Ve;function ie(){return oe()?window.location:void 0}A.getLocation=ie;function Be(){return oe()?window:void 0}A.getWindow=Be;function oe(){return typeof window<"u"}});var ce=g(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.handleAppPrint=void 0;var ae=z();function He(){return navigator.userAgent.indexOf("iOS")>=0}function Ge(){var e=ae.getWindow();if(!(!e||!e.document||!e.document.body)){var r=e.document.createElement("input");return r.style.display="none",e.document.body.appendChild(r),r}}function ue(){var e;(e=ae.getWindow())===null||e===void 0||e.print()}function ke(){var e=Ge();e&&(e.select(),ue(),e.remove())}function Ke(){He()?ke():ue()}U.handleAppPrint=Ke});var J=g(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.isV1Config=_.MessageType=_.LifecycleHook=_.PermissionType=void 0;var ze=H();Object.defineProperty(_,"MessageType",{enumerable:!0,get:function(){return ze.MessageType}});var se=H();Object.defineProperty(_,"PermissionType",{enumerable:!0,get:function(){return se.PermissionType}});Object.defineProperty(_,"LifecycleHook",{enumerable:!0,get:function(){return se.LifecycleHook}});function Je(e){return!e.host}_.isV1Config=Je});var fe=g(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.removeFromCollection=D.addAndRemoveFromCollection=void 0;var de=x();Object.defineProperty(D,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return de.addAndRemoveFromCollection}});Object.defineProperty(D,"removeFromCollection",{enumerable:!0,get:function(){return de.removeFromCollection}})});var le=g(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var Qe=fe(),Xe=function(){function e(){this.map={}}return e.prototype.set=function(r,n){Object.prototype.hasOwnProperty.call(this.map,r)||(this.map[r]=[]);var t={handler:n,remove:function(){}},o=Qe.addAndRemoveFromCollection(this.map[r],t);return t={handler:n,remove:o},o},e.prototype.get=function(r){var n=this.map[r];return n?n.map(function(t){return t.handler}):void 0},e.prototype.run=function(r,n,t){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];var i=0,s=this.get(r)||[];function u(){for(var f=[],c=0;c<arguments.length;c++)f[c]=arguments[c];var h=s[i++];return h?h(u).apply(t,f):n.apply(t,f)}return u.apply(t,o)},e}();Q.default=Xe});var X=g(d=>{"use strict";var E=d&&d.__assign||function(){return E=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},E.apply(this,arguments)},ve=d&&d.__spreadArray||function(e,r){for(var n=0,t=r.length,o=e.length;n<t;n++,o++)e[o]=r[n];return e},Ye=d&&d.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d,"__esModule",{value:!0});d.createApp=d.createAppWrapper=d.createClientApp=d.WINDOW_UNDEFINED_MESSAGE=void 0;var S=Me(),Ze=Pe(),v=$(),he=K(),ge=ne(),pe=De(),$e=Ee(),xe=Ne(),er=ce(),q=z(),I=J(),rr=Ye(le());d.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";function tr(e,r){var n=r.apiKey,t=r.host,o=r.forceRedirect,a=o===void 0?!pe.isDevelopmentClient:o,i=q.getLocation();if(pe.isUnframed||!i||!n||!t||!a||!q.shouldRedirect(e))return!1;var s="https://"+t+"/apps/"+n+i.pathname+(i.search||"");return q.redirect(s),!0}var nr=function(e){return function(r){return e(E(E({},r),{version:S.getVersion(),clientInterface:{name:S.getPackageName(),version:S.getVersion()}}))}},ir=function(e){e.set(I.LifecycleHook.DispatchAction,nr)};function or(e){e.subscribe(Ze.Action.APP,er.handleAppPrint),e.dispatch($e.initialize());try{xe.initializeWebVitals(e)}catch(r){console.error("App-Bridge failed to initialize web-vitals",r)}}var ar=function(e,r){r===void 0&&(r=[]);var n=[],t=he.createTransportListener(),o=function(a){var i=a.data,s=i.type,u=i.payload;switch(s){case"getState":{var f=n.splice(0);f.forEach(function(M){return M(u)});break}case"dispatch":{t.handleMessage(u);var c=t.handleActionDispatch(u);if(c)return;var h=S.findMatchInEnum(v.Action,u.type);h&&v.throwError(h,u);break}default:}};return e.subscribe(o),function(a){var i=ur(a),s=tr(e.hostFrame,i);if(s)return ge.mockAppBridge;var u=cr(e,i),f=t.createSubscribeHandler(u);u(I.MessageType.Unsubscribe);function c(l){return u(I.MessageType.Dispatch,l),l}for(var h=new URL("https://"+i.host).origin,M=new rr.default,P={hostOrigin:h,localOrigin:e.localOrigin,hooks:M,dispatch:function(l){return P.hooks?P.hooks.run(I.LifecycleHook.DispatchAction,c,P,l):c(l)},featuresAvailable:function(){for(var l=[],b=0;b<arguments.length;b++)l[b]=arguments[b];var p=l[0],m=Array.isArray(p)?ve([],p):l;return P.getState("features").then(function(j){return m.length?m.reduce(function(N,B){return Object.keys(j).includes(B)&&(N[B]=j[B]),N},{}):j})},getState:function(l){return l&&typeof l!="string"?Promise.resolve(void 0):new Promise(function(b){n.push(b),u(I.MessageType.GetState)}).then(function(b){var p=b;if(l)for(var m=0,j=l.split(".");m<j.length;m++){var N=j[m];if(p==null||typeof p!="object"||Array.isArray(p)||!Object.keys(p).includes(N))return;p=p[N]}return p})},subscribe:f,error:function(l,b){var p=[];return S.forEachInEnum(v.Action,function(m){p.push(f(m,l,b))}),function(){p.forEach(function(m){return m()})}}},V=0,Z=r;V<Z.length;V++){var Oe=Z[V];Oe(M,P)}return or(P),P}};d.createClientApp=ar;function ur(e){var r;if(!e.host)throw v.fromAction("host must be provided",v.AppActionType.INVALID_CONFIG);if(!e.apiKey)throw v.fromAction("apiKey must be provided",v.AppActionType.INVALID_CONFIG);try{var n=atob((r=e.host)===null||r===void 0?void 0:r.replace(/_/g,"/").replace(/-/g,"+"));return E(E({},e),{host:n})}catch{var t="not a valid host, please use the value provided by Shopify";throw v.fromAction(t,v.AppActionType.INVALID_CONFIG)}}function ye(e,r,n){if(n===void 0&&(n=[]),!e)throw v.fromAction(d.WINDOW_UNDEFINED_MESSAGE,v.AppActionType.WINDOW_UNDEFINED);var t=q.getLocation(),o=r||t&&t.origin;if(!o)throw v.fromAction("local origin cannot be blank",v.AppActionType.MISSING_LOCAL_ORIGIN);var a=he.fromWindow(e,o),i=d.createClientApp(a,ve([ir],n));return i}d.createAppWrapper=ye;function be(e){var r=q.getWindow();return!r||!r.top?ge.serverAppBridge:ye(r.top)(e)}d.createApp=be;function cr(e,r){return function(n,t){e.dispatch({payload:t,source:r,type:n})}}d.default=be});var Y=g(O=>{"use strict";var sr=O&&O.__createBinding||(Object.create?function(e,r,n,t){t===void 0&&(t=n),Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,t){t===void 0&&(t=n),e[t]=r[n]}),me=O&&O.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&sr(r,e,n)};Object.defineProperty(O,"__esModule",{value:!0});var dr=X();me(J(),O);me(X(),O);O.default=dr.createClientApp});var _e=g(w=>{"use strict";var fr=w&&w.__createBinding||(Object.create?function(e,r,n,t){t===void 0&&(t=n),Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,t){t===void 0&&(t=n),e[t]=r[n]}),Ae=w&&w.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&fr(r,e,n)};Object.defineProperty(w,"__esModule",{value:!0});w.default=void 0;var lr=Y();Object.defineProperty(w,"default",{enumerable:!0,get:function(){return lr.createApp}});Ae(K(),w);Ae(Y(),w)});var pr=g((Pr,we)=>{we.exports=_e()});export default pr();
